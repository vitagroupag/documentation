{
  "openapi": "3.0.1",
  "info": {
    "title": "OpenAPI definition",
    "version": "v0"
  },
  "servers": [
    {
      "url": "https://hip-cdr-mapping-config-cdr-bridge-integration.vitasystems.dev",
      "description": "Generated server url"
    }
  ],
  "paths": {
    "/api/v1/mappings/custom/{mappingId}": {
      "put": {
        "tags": ["Custom Mappings"],
        "operationId": "updateCustomMappingBundle",
        "parameters": [
          {
            "name": "mappingId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomMappingBundleInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomMappingBundleSummaryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/configuration/outbound/hl7v2": {
      "get": {
        "tags": ["HL7v2 Outbound Configuration"],
        "operationId": "getHL7v2OutboundConfig",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HL7v2OutboundConfig"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["HL7v2 Outbound Configuration"],
        "operationId": "putHL7v2OutboundConfig",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HL7v2OutboundConfig"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HL7v2OutboundConfig"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["HL7v2 Outbound Configuration"],
        "operationId": "deleteHL7v2OutboundConfig",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          }
        }
      }
    },
    "/api/v1/templates": {
      "post": {
        "tags": ["openEHR Templates"],
        "operationId": "uploadTemplateForTenant",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/xml": {
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mappings/product": {
      "get": {
        "tags": ["Product Mappings"],
        "operationId": "getProductMappingBundleSummaries",
        "parameters": [
          {
            "name": "active",
            "in": "query",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Product Mappings"],
        "operationId": "activateProductMappingBundle",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ProductMappingBundleActivation"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ActiveProductMappingBundleSummaryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mappings/custom": {
      "get": {
        "tags": ["Custom Mappings"],
        "operationId": "getCustomMappingBundleSummaries",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CustomMappingBundleSummaryResponse"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Custom Mappings"],
        "operationId": "createCustomMappingBundle",
        "parameters": [
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomMappingBundleInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomMappingBundleSummaryResponse"
                }
              }
            }
          },
          "404": {
            "description": "Not Found",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomMappingBundleSummaryResponse"
                }
              }
            }
          },
          "409": {
            "description": "Conflict",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomMappingBundleSummaryResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mappings/product/{mappingId}/{mappingVersion}": {
      "get": {
        "tags": ["Product Mappings"],
        "operationId": "getProductMappingBundle",
        "parameters": [
          {
            "name": "mappingId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "mappingVersion",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductMappingBundleResponse"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mappings/custom/{mappingId}/{mappingVersion}": {
      "get": {
        "tags": ["Custom Mappings"],
        "operationId": "getCustomMappingBundle",
        "parameters": [
          {
            "name": "mappingId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "mappingVersion",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomMappingBundleResponse"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AnyExpectedValueMappingCondition": {
        "required": ["anyExpectedValue", "condition"],
        "type": "object",
        "allOf": [
          {
            "$ref": "#/components/schemas/MappingCondition"
          },
          {
            "type": "object",
            "properties": {
              "condition": {
                "type": "string"
              },
              "anyExpectedValue": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        ]
      },
      "CustomMappingBundleInput": {
        "required": ["definition"],
        "type": "object",
        "properties": {
          "definition": {
            "$ref": "#/components/schemas/DefinitionInput"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          }
        }
      },
      "DefinitionInput": {
        "required": ["conditions", "sourceProtocol", "sourceProtocolVersions", "sourceType", "storageProtocol", "storageProtocolVersion", "storageType"],
        "type": "object",
        "properties": {
          "templateId": {
            "type": "string"
          },
          "sourceProtocol": {
            "type": "string"
          },
          "sourceProtocolVersions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "sourceType": {
            "type": "string"
          },
          "storageProtocol": {
            "type": "string"
          },
          "storageProtocolVersion": {
            "type": "string"
          },
          "storageType": {
            "type": "string"
          },
          "transformations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Transformation"
            }
          },
          "conditions": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          },
          "updateConditions": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          },
          "merges": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          }
        }
      },
      "ExpectedValueMappingCondition": {
        "required": ["condition", "expectedValue"],
        "type": "object",
        "allOf": [
          {
            "$ref": "#/components/schemas/MappingCondition"
          },
          {
            "type": "object",
            "properties": {
              "condition": {
                "type": "string"
              },
              "expectedValue": {
                "type": "string"
              }
            }
          }
        ]
      },
      "ExpectedValueTransformationCondition": {
        "required": ["expectedValue", "sourcePath"],
        "type": "object",
        "allOf": [
          {
            "$ref": "#/components/schemas/TransformationCondition"
          },
          {
            "type": "object",
            "properties": {
              "sourcePath": {
                "type": "string"
              },
              "expectedValue": {
                "type": "string"
              }
            }
          }
        ]
      },
      "IsEmptyTransformationCondition": {
        "required": ["isEmpty", "sourcePath"],
        "type": "object",
        "allOf": [
          {
            "$ref": "#/components/schemas/TransformationCondition"
          },
          {
            "type": "object",
            "properties": {
              "sourcePath": {
                "type": "string"
              },
              "isEmpty": {
                "type": "boolean"
              }
            }
          }
        ]
      },
      "MappingCondition": {
        "type": "object"
      },
      "Transformation": {
        "required": ["storageClass", "storagePath"],
        "type": "object",
        "properties": {
          "storageClass": {
            "type": "string"
          },
          "storagePath": {
            "type": "string"
          },
          "attributes": {
            "type": "object",
            "additionalProperties": {
              "type": "object"
            }
          },
          "conditions": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/ExpectedValueTransformationCondition"
                },
                {
                  "$ref": "#/components/schemas/IsEmptyTransformationCondition"
                }
              ]
            }
          }
        }
      },
      "TransformationCondition": {
        "type": "object"
      },
      "CustomMappingBundleSummaryResponse": {
        "required": ["authorId", "createdAt", "mappingId", "modifiedAt", "version"],
        "type": "object",
        "properties": {
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "mappingId": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          },
          "modifiedAt": {
            "type": "string",
            "format": "date-time"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "authorId": {
            "type": "string"
          }
        }
      },
      "HL7v2OutboundConfig": {
        "required": ["protocolVersion", "recipient"],
        "type": "object",
        "properties": {
          "recipient": {
            "$ref": "#/components/schemas/HL7v2OutboundRecipient"
          },
          "protocolVersion": {
            "type": "string"
          }
        }
      },
      "HL7v2OutboundRecipient": {
        "required": ["application", "facility", "hostname", "port"],
        "type": "object",
        "properties": {
          "application": {
            "type": "string"
          },
          "facility": {
            "type": "string"
          },
          "hostname": {
            "type": "string"
          },
          "port": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "ProductMappingBundleActivation": {
        "required": ["mappingId", "version"],
        "type": "object",
        "properties": {
          "mappingId": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          }
        }
      },
      "ActiveProductMappingBundleSummaryResponse": {
        "required": ["activatedAt", "activatedBy", "mappingId", "type", "version"],
        "type": "object",
        "properties": {
          "activatedAt": {
            "type": "string",
            "format": "date-time"
          },
          "activatedBy": {
            "type": "string"
          },
          "mappingId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          },
          "type": {
            "type": "string"
          }
        }
      },
      "Definition": {
        "required": [
          "conditions",
          "mappingId",
          "sourceProtocol",
          "sourceProtocolVersions",
          "sourceType",
          "storageProtocol",
          "storageProtocolVersion",
          "storageType",
          "updateConditions",
          "version"
        ],
        "type": "object",
        "properties": {
          "mappingId": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          },
          "templateId": {
            "type": "string"
          },
          "sourceProtocol": {
            "type": "string"
          },
          "sourceProtocolVersions": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "sourceType": {
            "type": "string"
          },
          "storageProtocol": {
            "type": "string"
          },
          "storageProtocolVersion": {
            "type": "string"
          },
          "storageType": {
            "type": "string"
          },
          "transformations": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Transformation"
            }
          },
          "conditions": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          },
          "updateConditions": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          },
          "merges": {
            "type": "array",
            "items": {
              "oneOf": [
                {
                  "$ref": "#/components/schemas/AnyExpectedValueMappingCondition"
                },
                {
                  "$ref": "#/components/schemas/ExpectedValueMappingCondition"
                }
              ]
            }
          }
        }
      },
      "ProductMappingBundleResponse": {
        "required": ["definitions", "mappingId", "type", "version"],
        "type": "object",
        "properties": {
          "definitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Definition"
            }
          },
          "mappingId": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          },
          "type": {
            "type": "string"
          }
        }
      },
      "CustomMappingBundleResponse": {
        "required": ["authorId", "createdAt", "definition", "mappingId", "modifiedAt", "version"],
        "type": "object",
        "properties": {
          "definition": {
            "$ref": "#/components/schemas/Definition"
          },
          "mappingId": {
            "type": "string"
          },
          "createdAt": {
            "type": "string",
            "format": "date-time"
          },
          "version": {
            "type": "integer",
            "format": "int32"
          },
          "modifiedAt": {
            "type": "string",
            "format": "date-time"
          },
          "name": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "authorId": {
            "type": "string"
          }
        }
      }
    }
  }
}
